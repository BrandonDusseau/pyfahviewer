language: python
script: true
os: linux

jobs:
  include:
    - language: python
      stage: build
      name: "Lint Python"
      python:
        - '3.5'
        - '3.6'
        - '3.7'
        - '3.8'
      env:
        - SKIP_INTERPRETER=true
      before_install:
        - git clone https://github.com/TravisToolbox/pycodestyle.git
      install:
        - "pip install -r requirements.txt"
        - "./pycodestyle/install.sh"
      script:
        - "./pycodestyle/scan.sh"

    - language: node_js
      stage: build
      name: "Lint JavaScript"
      node_js: 13
      install:
        - npm install -g eslint
      script: eslint pyfahviewer/static/*.js

    - name: "Draft GitHub Release"
      stage: deploy
      if: tag IS present
      deploy:
        provider: releases
        api_key:
          secure: bca6p8tBTvrtB6K/2IHoM0DbHFmm87fZzNqyhb/mPXzoz7EMG72k2ix6ofuNXT+6yRwm/pRsvHTIu3l3k3yIEwAKYm7i7l9qCUTPjtD6/PRA/+ygTKQlrcVNqr7OWxpEOh1U8VMhaRbJha7Oje3IdAK87YrTsmOc795vrPmMErN5Fm+YvT7B0N1YLBX+Q79aMQFhWjqNnk88nMJ7yHTEuwFvszGpwGfjZlVOJDTtnjwmaZGg+AFObHULFdLldSE1swoMssArgKXyNzsUHvndioDJcpckkfXNtpX5kebMzf7nHYH7RYSWSHW4/lhNxvF3SZN/wUrZE2HkWd9AaaU6cST+JII7L+UitqAXAKmUfsieaiHuXFDroMihE0cuV8PNVuQtRNZPx4P+9A/LkGAj7laRFhoEG0GGsuch9UX6GzavGjTYF+DQizZiVwBd5INgCjE+Qs3GHZ/1KlHNHUbCB5MXFBQSIh11W8cfqd2lRwLtz9rzDBscJcTDQ6MvQ+3fm4uCIBh96j3z1JuPMOZtyHny1SymCDnOUfSUKmJdfRhMM+F9jL5Vmvy4TQuVzATLdujldXmAYrFOMshWWA/j3gGBEpNSKptNqZ4kWw1jzMm6hcreeC3mbuKygbSw4u2NN4n5NwnkEyX1OVENdxNHYLoqjAMpFmuRXr2LrnLbjpY=
        name: "$TRAVIS_TAG"
        draft: true
        overwrite: true
        on:
          tags: true
